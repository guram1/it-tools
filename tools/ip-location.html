<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IP Location Lookup ‚Äî Find Any IP Address Geolocation | OPS-BOX</title>
    <meta name="description" content="Free IP geolocation lookup tool. Find the location, ISP, ASN, and timezone of any IP address. Supports IPv4 and IPv6. Bulk IP lookup available.">
    <meta name="keywords" content="IP location lookup, IP geolocation, IP address lookup, find IP location, IP to location, ASN lookup, ISP lookup, IP tracker">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://ops-box.net/tools/ip-location.html">
    
    <meta property="og:title" content="IP Location Lookup ‚Äî Find Any IP Address Geolocation">
    <meta property="og:description" content="Look up the geographic location, ISP, and ASN of any IP address.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://ops-box.net/tools/ip-location.html">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "IP Location Lookup",
        "url": "https://ops-box.net/tools/ip-location.html",
        "description": "Look up the geographic location, ISP, and ASN of any IP address",
        "applicationCategory": "NetworkingApplication",
        "operatingSystem": "Any",
        "offers": {"@type": "Offer", "price": "0", "priceCurrency": "USD"},
        "featureList": [
            "IP geolocation lookup",
            "City and country detection",
            "ISP identification",
            "ASN lookup",
            "Bulk IP lookup",
            "My IP detection"
        ]
    }
    </script>
    
    <style>
        .my-ip-banner {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .my-ip-banner .label {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        .my-ip-banner .ip {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            color: var(--accent);
            font-weight: 500;
        }
        
        .my-ip-banner .btn {
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }
        
        .ip-input-section {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }
        
        .ip-input-section .form-input {
            flex: 1;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .ip-result {
            display: none;
            margin-top: 1.5rem;
        }
        
        .ip-hero {
            text-align: center;
            padding: 1.5rem;
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border);
            border-radius: 12px;
            margin-bottom: 1.5rem;
        }
        
        .ip-address {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2rem;
            font-weight: 600;
            color: var(--accent);
            margin: 0.75rem 0;
            word-break: break-all;
        }
        
        .ip-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }
        
        .ip-location-text {
            font-size: 1.2rem;
            color: var(--text-primary);
            margin-top: 0.5rem;
        }
        
        .ip-location-text .flag {
            font-size: 1.4rem;
            margin-right: 0.5rem;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 0.75rem;
            margin-top: 1rem;
        }
        
        .info-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1rem;
            position: relative;
        }
        
        .info-card .icon {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }
        
        .info-card .label {
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            margin-bottom: 0.4rem;
        }
        
        .info-card .value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--text-primary);
            word-break: break-all;
        }
        
        .info-card .copy-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 0.25rem;
            opacity: 0;
            transition: opacity 0.2s;
            font-size: 0.85rem;
        }
        
        .info-card:hover .copy-btn {
            opacity: 1;
        }
        
        .info-card .copy-btn:hover {
            color: var(--accent);
        }
        
        .map-container {
            margin-top: 1.5rem;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border);
            background: var(--bg-secondary);
        }
        
        .map-container iframe {
            width: 100%;
            height: 280px;
            border: none;
        }
        
        .map-placeholder {
            height: 280px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
        }
        
        .loading-inline {
            display: none;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem;
            color: var(--text-muted);
        }
        
        .loading-inline.active {
            display: flex;
        }
        
        .spinner-small {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .error-box {
            display: none;
            padding: 1rem;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 8px;
            color: #ef4444;
            margin-top: 1rem;
        }
        
        .bulk-section {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border);
        }
        
        .bulk-section h3 {
            font-size: 1rem;
            margin-bottom: 1rem;
        }
        
        .bulk-results {
            display: none;
            margin-top: 1rem;
            overflow-x: auto;
        }
        
        .bulk-results table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.8rem;
        }
        
        .bulk-results th,
        .bulk-results td {
            padding: 0.6rem 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        
        .bulk-results th {
            color: var(--text-muted);
            font-weight: 500;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            background: var(--bg-secondary);
        }
        
        .bulk-results td {
            font-family: 'JetBrains Mono', monospace;
        }
        
        .copy-all-section {
            margin-top: 1.5rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
        }
        
        .copy-all-section textarea {
            width: 100%;
            min-height: 100px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 0.75rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-primary);
            resize: vertical;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <a href="/" class="logo">
                <div class="logo-icon">‚ö°</div>
                <div class="logo-text">OPS<span>-BOX</span></div>
            </a>
            <nav class="header-nav">
                <a href="/tools/subnet-calculator.html">Subnet</a>
                <a href="/tools/mac-vendor-lookup.html">MAC Lookup</a>
                <a href="/tools/ssl-checker.html">SSL Check</a>
                <a href="/tools/ip-location.html">IP Location</a>
            </nav>
        </div>
    </header>

    <main>
        <nav class="breadcrumb">
            <a href="/">Home</a><span>‚Ä∫</span><span class="breadcrumb-current">IP Location Lookup</span>
        </nav>

        <div class="tool-container">
            <div class="tool-header">
                <h1 class="tool-title">IP Location Lookup</h1>
                <p class="tool-description">Look up the geographic location, ISP, ASN, and timezone of any public IP address.</p>
            </div>
            
            <div class="tool-content">
                <!-- Your IP Banner -->
                <div class="my-ip-banner">
                    <div>
                        <div class="label">Your IP Address</div>
                        <div class="ip" id="myIP">Detecting...</div>
                    </div>
                    <button class="btn btn-secondary" onclick="lookupMyIP()">Look Up My IP</button>
                </div>
                
                <!-- IP Input -->
                <div class="form-group">
                    <label class="form-label">Enter IP Address to Look Up</label>
                    <div class="ip-input-section">
                        <input type="text" class="form-input" id="ipInput" placeholder="8.8.8.8 or 2001:4860:4860::8888">
                        <button class="btn btn-primary" onclick="lookupIP()">Look Up</button>
                    </div>
                </div>
                
                <div class="loading-inline" id="loading">
                    <div class="spinner-small"></div>
                    <span>Looking up IP address...</span>
                </div>
                
                <div class="error-box" id="errorBox"></div>
                
                <!-- Single IP Result -->
                <div class="ip-result" id="ipResult">
                    <div class="ip-hero">
                        <div class="ip-label">IP Address</div>
                        <div class="ip-address" id="resultIP">‚Äî</div>
                        <div class="ip-location-text">
                            <span class="flag" id="countryFlag"></span>
                            <span id="locationText">‚Äî</span>
                        </div>
                    </div>
                    
                    <div class="info-grid">
                        <div class="info-card">
                            <button class="copy-btn" onclick="copyField('city')">üìã</button>
                            <div class="icon">üèôÔ∏è</div>
                            <div class="label">City</div>
                            <div class="value" id="city">‚Äî</div>
                        </div>
                        <div class="info-card">
                            <button class="copy-btn" onclick="copyField('region')">üìã</button>
                            <div class="icon">üìç</div>
                            <div class="label">Region / State</div>
                            <div class="value" id="region">‚Äî</div>
                        </div>
                        <div class="info-card">
                            <button class="copy-btn" onclick="copyField('country')">üìã</button>
                            <div class="icon">üåç</div>
                            <div class="label">Country</div>
                            <div class="value" id="country">‚Äî</div>
                        </div>
                        <div class="info-card">
                            <button class="copy-btn" onclick="copyField('timezone')">üìã</button>
                            <div class="icon">üïê</div>
                            <div class="label">Timezone</div>
                            <div class="value" id="timezone">‚Äî</div>
                        </div>
                        <div class="info-card">
                            <button class="copy-btn" onclick="copyField('isp')">üìã</button>
                            <div class="icon">üåê</div>
                            <div class="label">ISP / Organization</div>
                            <div class="value" id="isp">‚Äî</div>
                        </div>
                        <div class="info-card">
                            <button class="copy-btn" onclick="copyField('asn')">üìã</button>
                            <div class="icon">üî¢</div>
                            <div class="label">ASN</div>
                            <div class="value" id="asn">‚Äî</div>
                        </div>
                        <div class="info-card">
                            <button class="copy-btn" onclick="copyField('latitude')">üìã</button>
                            <div class="icon">üìê</div>
                            <div class="label">Latitude</div>
                            <div class="value" id="latitude">‚Äî</div>
                        </div>
                        <div class="info-card">
                            <button class="copy-btn" onclick="copyField('longitude')">üìã</button>
                            <div class="icon">üìê</div>
                            <div class="label">Longitude</div>
                            <div class="value" id="longitude">‚Äî</div>
                        </div>
                    </div>
                    
                    <!-- Map -->
                    <div class="map-container" id="mapContainer">
                        <div class="map-placeholder">Map will appear here</div>
                    </div>
                    
                    <!-- Copy All Section -->
                    <div class="copy-all-section">
                        <div class="label" style="font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase;">Full Details</div>
                        <textarea id="fullDetails" readonly onclick="copyFullDetails()"></textarea>
                        <div class="btn-group" style="margin-top: 0.5rem;">
                            <button class="btn btn-secondary" onclick="copyFullDetails()">Copy All</button>
                        </div>
                    </div>
                </div>
                
                <!-- Bulk Lookup Section -->
                <div class="bulk-section">
                    <h3>Bulk IP Lookup</h3>
                    <div class="form-group">
                        <label class="form-label">Multiple IP Addresses (one per line, max 20)</label>
                        <textarea class="form-textarea" id="bulkIPs" placeholder="8.8.8.8
1.1.1.1
208.67.222.222"></textarea>
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="bulkLookup()">Look Up All</button>
                        <button class="btn btn-secondary" onclick="exportBulkCSV()" id="exportBtn" style="display:none;">Export CSV</button>
                    </div>
                    
                    <div class="bulk-results" id="bulkResults">
                        <table>
                            <thead>
                                <tr>
                                    <th>IP Address</th>
                                    <th>City</th>
                                    <th>Country</th>
                                    <th>ISP</th>
                                    <th>ASN</th>
                                </tr>
                            </thead>
                            <tbody id="bulkResultsBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <section class="seo-content">
            <h2>About IP Geolocation Lookup</h2>
            <p>IP geolocation allows you to determine the approximate physical location of any public IP address. This tool uses multiple data sources to provide accurate information about IP addresses worldwide.</p>
            
            <h3>What Information Can You Find?</h3>
            <ul>
                <li><strong>Geographic Location</strong> ‚Äî City, region/state, and country</li>
                <li><strong>Internet Service Provider (ISP)</strong> ‚Äî The company that owns the IP</li>
                <li><strong>ASN (Autonomous System Number)</strong> ‚Äî Network identifier for routing</li>
                <li><strong>Timezone</strong> ‚Äî Based on geographic location</li>
                <li><strong>Coordinates</strong> ‚Äî Approximate latitude and longitude</li>
            </ul>
            
            <h3>Common Use Cases</h3>
            <ul>
                <li><strong>Security Analysis</strong> ‚Äî Identify the origin of suspicious traffic or attacks</li>
                <li><strong>Fraud Prevention</strong> ‚Äî Verify if user locations match claimed locations</li>
                <li><strong>Network Troubleshooting</strong> ‚Äî Trace routing issues and identify network paths</li>
                <li><strong>Compliance</strong> ‚Äî Verify geographic restrictions and data residency</li>
                <li><strong>Marketing</strong> ‚Äî Understand visitor demographics and locations</li>
            </ul>
            
            <h3>Accuracy Notes</h3>
            <p>IP geolocation is accurate to the city level in most cases, but may only be accurate to country or region level for some IPs. VPNs, proxies, and mobile networks can affect accuracy. The location represents where the IP is registered, not necessarily the user's exact location.</p>
        </section>

        <section class="related-tools">
            <h2>Related Tools</h2>
            <div class="related-grid">
                <a href="/tools/subnet-calculator.html" class="related-card">
                    <h3>Subnet Calculator</h3>
                    <p>Calculate network addresses, VLSM, and plan IP allocations.</p>
                </a>
                <a href="/tools/mac-vendor-lookup.html" class="related-card">
                    <h3>MAC Vendor Lookup</h3>
                    <p>Identify device manufacturers from MAC addresses.</p>
                </a>
                <a href="/tools/ssl-checker.html" class="related-card">
                    <h3>SSL Certificate Checker</h3>
                    <p>Check SSL certificate expiry dates for your domains.</p>
                </a>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>Network Tools</h3>
                <a href="/tools/subnet-calculator.html">Subnet Calculator</a>
                <a href="/tools/mac-vendor-lookup.html">MAC Vendor Lookup</a>
                <a href="/tools/ssl-checker.html">SSL Checker</a>
                <a href="/tools/ip-location.html">IP Location</a>
            </div>
            <div class="footer-section">
                <h3>Security Tools</h3>
                <a href="/tools/password-generator.html">Password Generator</a>
                <a href="/tools/hash-generator.html">Hash Generator</a>
                <a href="/tools/uuid-generator.html">UUID Generator</a>
            </div>
            <div class="footer-section">
                <h3>Developer Tools</h3>
                <a href="/tools/json-formatter.html">JSON Formatter</a>
                <a href="/tools/base64-encoder.html">Base64 Encoder</a>
                <a href="/tools/wifi-qr-generator.html">WiFi QR Generator</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 OPS-BOX.net ‚Äî Free IT utilities for professionals.</p>
        </div>
    </footer>

    <div class="toast" id="toast">Copied to clipboard!</div>

    <script src="../js/common.js"></script>
    <script>
        const MY_IP_API = 'https://api.ipify.org?format=json';
        const IP_LOOKUP_API = 'https://ip-api.com/json/'; // Free IP geolocation API
        let currentData = null;
        let bulkData = [];
        
        // Country code to flag emoji
        function countryToFlag(countryCode) {
            if (!countryCode || countryCode.length !== 2) return 'üåç';
            const codePoints = countryCode
                .toUpperCase()
                .split('')
                .map(char => 127397 + char.charCodeAt(0));
            return String.fromCodePoint(...codePoints);
        }
        
        // Detect user's own IP on page load
        async function detectMyIP() {
            try {
                const response = await fetch(MY_IP_API);
                const data = await response.json();
                document.getElementById('myIP').textContent = data.ip || 'Unknown';
            } catch (e) {
                document.getElementById('myIP').textContent = 'Could not detect';
            }
        }
        
        // Look up user's own IP
        function lookupMyIP() {
            const myIP = document.getElementById('myIP').textContent;
            if (myIP && myIP !== 'Detecting...' && myIP !== 'Could not detect' && myIP !== 'Unknown') {
                document.getElementById('ipInput').value = myIP;
                lookupIP();
            }
        }
        
        // Look up any IP
        async function lookupIP() {
            const ip = document.getElementById('ipInput').value.trim();
            if (!ip) {
                alert('Please enter an IP address');
                return;
            }
            
            document.getElementById('loading').classList.add('active');
            document.getElementById('ipResult').style.display = 'none';
            document.getElementById('errorBox').style.display = 'none';
            
            try {
                // Using ip-api.com (free, no API key needed, 45 requests/minute)
                const response = await fetch(`${IP_LOOKUP_API}${encodeURIComponent(ip)}?fields=status,message,country,countryCode,region,regionName,city,zip,lat,lon,timezone,isp,org,as,query`);
                const data = await response.json();
                
                document.getElementById('loading').classList.remove('active');
                
                if (data.status === 'fail') {
                    throw new Error(data.message || 'Invalid IP address or lookup failed');
                }
                
                currentData = data;
                displayResult(data);
                
            } catch (error) {
                document.getElementById('loading').classList.remove('active');
                document.getElementById('errorBox').textContent = 'Error: ' + error.message;
                document.getElementById('errorBox').style.display = 'block';
            }
        }
        
        function displayResult(data) {
            document.getElementById('ipResult').style.display = 'block';
            
            // Main display
            document.getElementById('resultIP').textContent = data.query || '‚Äî';
            
            // Location text
            const locationParts = [];
            if (data.city) locationParts.push(data.city);
            if (data.regionName) locationParts.push(data.regionName);
            if (data.country) locationParts.push(data.country);
            document.getElementById('locationText').textContent = locationParts.join(', ') || 'Unknown';
            
            // Flag
            document.getElementById('countryFlag').textContent = countryToFlag(data.countryCode);
            
            // Info cards
            document.getElementById('city').textContent = data.city || '‚Äî';
            document.getElementById('region').textContent = data.regionName || '‚Äî';
            document.getElementById('country').textContent = data.country || '‚Äî';
            document.getElementById('timezone').textContent = data.timezone || '‚Äî';
            document.getElementById('isp').textContent = data.isp || data.org || '‚Äî';
            document.getElementById('asn').textContent = data.as || '‚Äî';
            document.getElementById('latitude').textContent = data.lat || '‚Äî';
            document.getElementById('longitude').textContent = data.lon || '‚Äî';
            
            // Map
            if (data.lat && data.lon) {
                const mapUrl = `https://www.openstreetmap.org/export/embed.html?bbox=${data.lon - 0.15},${data.lat - 0.1},${data.lon + 0.15},${data.lat + 0.1}&layer=mapnik&marker=${data.lat},${data.lon}`;
                document.getElementById('mapContainer').innerHTML = `<iframe src="${mapUrl}" loading="lazy"></iframe>`;
            } else {
                document.getElementById('mapContainer').innerHTML = '<div class="map-placeholder">Map unavailable</div>';
            }
            
            // Full details
            const details = `IP Address: ${data.query || '‚Äî'}
City: ${data.city || '‚Äî'}
Region: ${data.regionName || '‚Äî'}
Country: ${data.country || '‚Äî'}
Timezone: ${data.timezone || '‚Äî'}
ISP: ${data.isp || '‚Äî'}
Organization: ${data.org || '‚Äî'}
ASN: ${data.as || '‚Äî'}
Latitude: ${data.lat || '‚Äî'}
Longitude: ${data.lon || '‚Äî'}
Coordinates: ${data.lat && data.lon ? `${data.lat}, ${data.lon}` : '‚Äî'}

Looked up with OPS-BOX.net`;
            
            document.getElementById('fullDetails').value = details;
        }
        
        function copyField(fieldId) {
            const value = document.getElementById(fieldId).textContent;
            if (value && value !== '‚Äî') {
                navigator.clipboard.writeText(value);
                showToast('Copied: ' + value);
            }
        }
        
        function copyFullDetails() {
            const textarea = document.getElementById('fullDetails');
            navigator.clipboard.writeText(textarea.value);
            showToast('All details copied!');
        }
        
        // Bulk lookup
        async function bulkLookup() {
            const input = document.getElementById('bulkIPs').value.trim();
            if (!input) {
                alert('Please enter at least one IP address');
                return;
            }
            
            const ips = input.split('\n').map(ip => ip.trim()).filter(ip => ip);
            
            if (ips.length === 0) {
                alert('No valid IP addresses found');
                return;
            }
            
            if (ips.length > 20) {
                alert('Maximum 20 IP addresses allowed');
                return;
            }
            
            bulkData = [];
            const tbody = document.getElementById('bulkResultsBody');
            tbody.innerHTML = '';
            document.getElementById('bulkResults').style.display = 'block';
            document.getElementById('exportBtn').style.display = 'none';
            
            for (const ip of ips) {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${ip}</td><td colspan="4">Looking up...</td>`;
                tbody.appendChild(row);
                
                try {
                    const response = await fetch(`${IP_LOOKUP_API}${encodeURIComponent(ip)}?fields=status,message,country,countryCode,regionName,city,isp,as,query`);
                    const data = await response.json();
                    
                    if (data.status === 'fail') {
                        row.innerHTML = `<td>${ip}</td><td colspan="4" style="color: #ef4444;">${data.message || 'Lookup failed'}</td>`;
                        bulkData.push({ ip, error: data.message || 'Failed' });
                    } else {
                        row.innerHTML = `
                            <td>${data.query}</td>
                            <td>${data.city || '‚Äî'}</td>
                            <td>${countryToFlag(data.countryCode)} ${data.country || '‚Äî'}</td>
                            <td>${data.isp || '‚Äî'}</td>
                            <td>${data.as || '‚Äî'}</td>
                        `;
                        bulkData.push({
                            ip: data.query,
                            city: data.city,
                            region: data.regionName,
                            country: data.country,
                            countryCode: data.countryCode,
                            isp: data.isp,
                            asn: data.as
                        });
                    }
                } catch (e) {
                    row.innerHTML = `<td>${ip}</td><td colspan="4" style="color: #ef4444;">Network error</td>`;
                    bulkData.push({ ip, error: 'Network error' });
                }
                
                // Rate limit: ip-api allows 45/minute, so add small delay
                await new Promise(r => setTimeout(r, 150));
            }
            
            document.getElementById('exportBtn').style.display = 'inline-flex';
        }
        
        function exportBulkCSV() {
            if (bulkData.length === 0) return;
            
            let csv = 'IP Address,City,Region,Country,ISP,ASN\n';
            bulkData.forEach(r => {
                if (r.error) {
                    csv += `"${r.ip}","Error","","","",""\n`;
                } else {
                    csv += `"${r.ip}","${r.city || ''}","${r.region || ''}","${r.country || ''}","${r.isp || ''}","${r.asn || ''}"\n`;
                }
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'ip-locations.csv';
            link.click();
            
            showToast('CSV exported!');
        }
        
        // Enter key support
        document.getElementById('ipInput').addEventListener('keypress', e => {
            if (e.key === 'Enter') lookupIP();
        });
        
        // Detect IP on load
        document.addEventListener('DOMContentLoaded', detectMyIP);
    </script>
</body>
</html>
